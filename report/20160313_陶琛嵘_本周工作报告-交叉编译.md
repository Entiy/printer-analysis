# 本周工作

## 前言
根据之前github上的任务分配，我负责两个方面的任务，一个是调研cups编译完成后生成的位于 /bin 及 /sbin 目录下的可执行文件的作用，以期考察能否对cups进行一些精简，另一个任务是交叉编译ghostscript以及foo2zjs至android_x86上，让其能够运行。

### 关于交叉编译：

简单来说，就是在宿主机上生成在目标机上能够执行的代码。

### 关于动态与静态编译：

动态编译的文件需要附带一个动态链接库，在文件执行时需要调用动态链接库中的一些命令，所以没有这个库就没办法运行。

* 优点：既缩小了执行文件本身的体积，又加快了编译的速度；

* 缺点：首先即便程序只用到了链接库很少的命令也需要携带一个庞大的动态链接库，否则程序无法执行，而且当其他设备上没有此链接库时就无法运行。
    
静态编译会在编译文件时将文件所需要调用的对应链接库(.so文件)中的部分提去出来，链接到可执行文件中去，是程序在执行时不依赖链接库。

可以看出动态编译与静态编译的优点与缺点基本是互补的，可移植性和编译速度两者对立。

## 目前进展

目前第一个任务已经部分完成，具体作用的记录文件位于项目的移植目录下，不过并没有找到可以精简之处，所以暂时搁置，开始完成第二个任务。

交叉编译的概念以前并不了解，所以首先进行了一些必要的了解，之后开始进行实际工作。首先下载ghostscript http://downloads.ghostscript.com/public/ 以及foo2zjs源码 http://www.foo2zjs.rkkda.com/ ,其中ghostscript下载的是9.14版本，之后开始进行编译。

在linux上对其进行了``./configure &&make以及 make install`` 操作，编译完成，通过`` ldd filename`` 来查询可执行文件是否有需要依赖的动态链接库，发现是动态编译。查阅参考的博客等资料，下载了arm-linux-gcc这个交叉编译工具(具体过程参考 http://www.cnblogs.com/tdyizhen1314/p/4124886.html )，编译过程中需要将pc版与arm版分别编译，因为在编译arm版本时会需要用到ghostscript的几个命令，所以先将pc版编译完成后再编译arm版本，在 ./configure时指定--prefix参数方便移植。

在移植过程中，其中部分软链接文件的拷贝过程出现问题，都位于man目录下，应该不影响可执行文件的执行，因此记录下来继续移植。

在虚拟机上安装android_x86_64后，使用adb工具在windows上对其进行连接，将文件push进android系统后进行实验，在给予执行权限后并不能执行，提示错误信息： 
```
./gs: not executable:32-bit ELF file
```

即32位文件不可执行，因虚拟机中系统为android_x86_64所以重新安装android_x86的32位系统，之后重新实验，结果仍是相同结果，正在查找原因及解决办法。

何兴鹏同学推测有两种原因可能性较大：

1. 所安装的x86安卓并不能运行arm程序
2. 程序编译的有问题，可能存在依赖等问题

#下周计划

查找编译完成的文件不能执行的原因，对其问题进行解决。

可能尝试使用gcc来进行静态编译，实验编译完成的文件是否能正常运行（参考http://blog.csdn.net/yang1982_0907/article/details/45601705 ）
